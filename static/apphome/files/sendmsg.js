
var __IS_APPBOX=(function(){var loc=location,mainURL=loc.protocol+'//'+loc.host;return loc.href.indexOf(mainURL+'/appbox/')===0||/[\?&]appbox(=[^&#]*)?/.test(loc.search);})();var query_user,widgets,Log,qq_login_mod;Log=(function(){var init,log,run;init=function(build,obj){log=build(obj);};run=function(oper){if(!log){return false;}
log(oper||'');}
return{init:init,run:run}})();seajs.use(['http://imgcache.qq.com/club/weiyun/js/common/special_log.js'],function(special_log){Log.init(special_log.build_logger,{send_to_phone_android:{act_id:1502,op_id:1},send_message_android:{act_id:1501,op_id:1},download_android:{act_id:1500,op_id:1},send_to_phone_ios:{act_id:1502,op_id:2},send_message_ios:{act_id:1501,op_id:2},download_ios:{act_id:1500,op_id:2},download_ipad:{act_id:1500,op_id:3}});});var check_login=function(fn){var new_fn=function(){widgets.mask.hide('sendmsg');fn();}
if(query_user&&qq_login_mod){jQuery("#show_diag").hide();jQuery('.ui-qqlogin').css('top','70px');widgets.mask.show('sendmsg');return qq_login_mod.show();}
seajs.use(['$','lib','common'],function($,lib,common){query_user=common.get('./query_user');widgets=common.get('./ui.widgets');seajs.use('qq_login',function(qq_login){qq_login_mod=qq_login.get('./qq_login');$("#show_diag").hide();qq_login_mod.show();widgets.mask.show('sendmsg');$('.ui-qqlogin').css('top','70px');qq_login_mod.on('qq_login_ok',function(){new_fn();});});});};(function(){var global=window;jQuery.ajax('/data/ad_config.json',{cache:false,dataType:'json',success:function(data){if(typeof data!=='object'){return;}
global.get_config_data=function(){return data;};jQuery.each(['windows','iphone','ipad','android'],function(idx,type){var item_el=jQuery('#list_'+type);if(item_el.length>0){if(type==='windows'){item_el.find('a').attr('href',data[type+'_url']);}
item_el.find('.version-text').text(data[type+'_version']);if(data[type+'_news']){item_el.find('.version-text').append('<span class="version_new"></span>');}
item_el.find('.version-feature-list li').each(function(idx,item){var li_el=jQuery(item);switch(idx){case 0:li_el.text('大小：'+data[type+'_size']);break;case 1:li_el.text('适合平台：'+data[type+'_plat']);break;case 2:li_el.text('更新时间：'+data[type+'_date']);break;};});}
_async_butcli_callback&&_async_butcli_callback();});}});})();var get_config_data,_async_butcli_callback;function butcli(flag)
{var qr_img_url=__IS_APPBOX?'http://imgcache.qq.com/vipstyle/nr/box/portal/demoImg/weiyunQR_app_appbox.png':'http://imgcache.qq.com/vipstyle/nr/box/portal/demoImg/weiyunQR_app_web.png';var config_data;if(!get_config_data){_async_butcli_callback=new Function('butcli('+flag+');');return;}
config_data=get_config_data();jQuery("#show_diag").show();jQuery('#show_diag2').hide();jQuery('#sendto-phone').hide();var download_dom=jQuery('.__download');switch(flag){case 1:jQuery('#show_diag').find('#sendto-phone').show();jQuery('#show_diag').find("#mobileType").html("微云Android版");jQuery('#first_download_method').show().find('h3').html('方法二：短信获取下载地址');jQuery('#second_download_method h3').text('方法二：下载安装包');jQuery('#second_download_method a').attr('href',__IS_APPBOX?config_data['android_appbox_url']:config_data['android_web_url']).attr('target',null);jQuery('#thirdAll h3').text('方法四：二维码获取');jQuery('#show_diag').find('.download-install').find('h3').eq(0).html('方法三： 下载安装包');jQuery('#show_diag').find('.get_code_area img').attr('src',qr_img_url);jQuery('#sendto-phone').find('a')[0].onclick=function(){Log.run('send_to_phone_android');};jQuery('#first_download_method').find('a')[0].onclick=function(){Log.run('send_message_android');};download_dom.unbind('click').bind('click',function(){Log.run('download_android');window.open(__IS_APPBOX?config_data['android_appbox_url']:config_data['android_web_url']);});jQuery('#mobile_num').focus();break;case 2:jQuery('#show_diag').find("#mobileType").html("微云iPhone版");jQuery('#first_download_method').show().find('h3').html('方法一：短信获取下载地址');jQuery('#second_download_method h3').text('方法二：前往App Store下载');jQuery('#second_download_method a').attr('href',config_data['iphone_url']).attr('target','_blank');jQuery('#thirdAll h3').text('方法三：二维码获取');jQuery('#show_diag').find('.download-install').find('h3').eq(0).html('方法二： 前往App Store下载');jQuery('#show_diag').find('.get_code_area img').attr('src',qr_img_url);jQuery('#sendto-phone').find('a')[0].onclick=function(){Log.run('send_to_phone_ios');};jQuery('#first_download_method').find('a')[0].onclick=function(){Log.run('send_message_ios');};download_dom.unbind('click').bind('click',function(){Log.run('download_ios');window.open('http://itunes.apple.com/cn/app/id522700349?mt=8&ls=1');});break;case 3:jQuery('#show_diag').find("#mobileType").html("微云Android特别版");jQuery('#show_diag').find('.get_code_area img').attr('src','http://imgcache.qq.com/vipstyle/nr/box/portal/demoImg/weiyunQR2.png');break;case 4:jQuery('#show_diag').hide();jQuery('#show_diag2').show().find('a').unbind('click').bind('click',function(){Log.run('download_ipad');window.open('https://itunes.apple.com/cn/app/teng-xun-wei-yunhd/id608263551?l=cn&amp;mt=8');});jQuery('#show_diag2').find('.get_code_area .des').text('使用iPad扫描以下二维码即可安装。');break;};jQuery('#sendMsg').unbind('click.EvtsendMsg').bind('click.EvtsendMsg',function(e){sendmsg(flag);});jQuery(".error_des").css("display","none");jQuery("#vip_act_page_mask").show();}
function tryagain()
{jQuery(".register_form").css("display","");jQuery(".register_success").css("display","none");jQuery(".error_des").css("display","none");}
function senddone()
{jQuery("#show_diag").hide();jQuery("#show_diag2").hide();jQuery(".register_form").css("display","");jQuery(".register_success").css("display","none");jQuery("#vip_act_page_mask").hide();jQuery(".error_des").css("display","none");jQuery("#mobile_num").val("");}
function sendmsg(flag)
{var num=jQuery("#mobile_num").val();if(isMobile(num))
{jQuery.get("http://www.weiyun.com/php/msgsend.php",{number:num,flag:flag,source:__IS_APPBOX?'appbox':'web'},function(data,textStatus){if(data.ret=="0")
{jQuery(".register_form").css("display","none");jQuery(".register_success").css("display","");}else if(data.ret=="6"||data.ret=="7")
{jQuery(".error_des").html("发送速率过快，请稍后再发,您还可以通过右侧二维码的方式快速安装微云。");jQuery(".error_des").css("display","");}else
{jQuery(".error_des").html("网络繁忙，暂不能发送短信，请稍后再试。建议您通过右侧二维码的方式快速安装微云。");jQuery(".error_des").css("display","");}},"json");}else
{jQuery(".error_des").css("display","");}}
function isMobile(str)
{if(/^1[358]\d{9}/.test(str))
{return true;}
return false;}
function thisMovie(movieName){if(navigator.appName.indexOf("Microsoft")!=-1){return window[movieName];}else{return document[movieName];}}
function play_video(){jQuery(".video_cover").css("display","");jQuery("#show_video").css("display","");};function close_video(){jQuery(".video_cover").css("display","none");jQuery("#show_video").css("display","none");}
function sendto_phone(){check_login(function(){var $=jQuery;var uin=query_user.get_uin(),skey=query_user.get_skey();var url='http://jump.weiyun.qq.com/set_cookie.php';url+='?uin='+uin+'&skey='+skey+'&url=http://www.weiyun.com/download_proxy_setcookie.html';var iframe=$('<iframe></iframe>').appendTo($('body')).hide();iframe.attr('src',url);});}
function loginSuccuess(){seajs.use('http://qzs.qq.com/open/canvas/pcpush.js',function(){PCPUSH.show(100720601,'EXTERNAL','随时在手机上玩');});}/*  |xGv00|cfbbc95a50aa5193098a5fcb89314209 */